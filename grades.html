<!DOCTYPE html>
<html>
<head>

		<!-- Get some nice font-->
    <link href='http://fonts.googleapis.com/css?family=PT+Sans:400,700' rel='stylesheet' type='text/css'>

	<style>
	#dashboard {
	  width: 97vw;
	  position: absolute;
	  padding-top: 1vh;
	  padding-left: 1vw;
	  padding-right: 1vw;
	  padding-bottom: 1vh;
	  display: inline-block;
	  /*background-color: #d3d3d3;*/
	}
	#overview {
	  width: 97vw;
	  height: 95vh;
	  left: 1vw;
	  display: show;
	  /*background-color: #ECECEC;*/
	}
	#header {
	  text-align: center;
	  width: 97vw;
	  height: 10vh;
	  left: 1vw;
	  position: absolute;
	  display: inline-block;
/*	  border-style: solid;
	  border-width: 1px;*/
	  /*background-color: #ECECEC;*/
	}
	#back {
	  position: absolute;
	  display: inline-block;
	}
	#weaknesses {
	  text-align: center;
	  width: 45vw;
	  height: 30vh;
	  margin-top: 12vh;
	  padding-top: 2px;
	  padding-bottom: 2px;
	  padding-left: 2px;
	  padding-right: 2px;
	  left: 2vw;
	  position: fixed;
	  display: inline-block;
	  border-style: solid;
	  border-width: 1px;
	/*  background-color: #FFFFEC;*/
	  overflow: auto;
	}
	#select {
	  text-align: center;
	  width: 10vw;
	  height: 23.8vh;
	  margin-top: 12vh;
	  left: 47vw;
	  position: fixed;
	  display: inline-block;
	  border-style: solid;
	  border-width: 1px;
/*	  background-color: #FFFFEC;*/
	  overflow: auto;
	  font-size: 20px;
	}
	#grades {
	  text-align: center;
	  width: 40vw;
	  height: 65vh;
	  margin-top: 18vh;
	  right: 2vw;
	  position: fixed;
	  display: inline-block;
	  border-style: solid;
	  border-width: 1px;
	  /*background-color: #FFFFEC;*/
	  overflow: auto;
	}
	#graph {
	  text-align: center;
	  width: 55vw;
	  top: 46vh;
	  left: 2vw;
	  margin-bottom: 1vh;
	  position: fixed;
	  display: inline-block;
	  border-style: solid;
	  border-width: 1px;
	/*  background-color: #FFFFEC;*/
	  overflow: auto;
	}
	.header {
		text-align: center;
		font-size: 20px;
	}
	.arrow-down {
	width: 0; 
	height: 0; 
	border-left: 10px solid transparent;
	border-right: 10px solid transparent;
	border-top: 10px solid black;
	float:left;
	}

	.arrow-down {
	width: 0; 
	height: 0; 
	border-left: 10px solid transparent;
	border-right: 10px solid transparent;
	border-top: 10px solid black;
	float:left;
	}

	.sub {
		float:left;
		margin-left: 50px;
	}

	.numeric {
		float:right;
		margin-right:50px;
	}

	body {
		font-family: Helvetica, sans-serif;
		background-color: #d3d3d3
	}
	</style>

	<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
	<script src="http://d3js.org/d3.v3.min.js"></script>
	<script src = "js/studentVis.js"></script>

	<script>

	var mathShow = false, histShow = false, sciShow = false, engShow = false;
	var string = "Joseph Song";
	var student;
	var graphVis;

	d3.json("data/studentData.json", function(error, data) {

		console.log(data);

		if (string = "Joseph") {
			student = data[0]
		}
		else if (string = "Roseanne") {
			student = data[1]
		}
		else {
			student = data[2]
		}

		graphVis = new ClassGraphs(d3.select("#graph"), student);

		var index = student.year.length-1;
		var keys = Object.keys(student.year[index].grades)
		var english = Object.keys(student.year[index].grades.english)
		var math = Object.keys(student.year[index].grades.math)
		var science = Object.keys(student.year[index].grades.science)
		var history = Object.keys(student.year[index].grades.history)
		console.log(keys)
		d3.select(".name").text(student.name)


		keys.forEach(function(d){
			d3.select("."+d).append("label").text("overall").style("float","left").style("font-weight","bold")
			d3.select("."+d).append("br")
			if (d=="math") {
				var arr = [];
				for (var i = 0; i<math.length;i++) {
					arr[i] = student.year[index].grades.math[math[i]]
				}
				var average = d3.mean(arr)
				if (average >= 90) {
					average = 'A'
				}
				else if (average >= 80 && average < 90) {
					average = 'B'
				}
				else if (average >= 70 && average < 80) {
					average = 'C'
				}
				else if (average >= 60 && average < 70) {
					average = 'D'
				}
				else {
					average = 'F'
				}
				d3.select("."+d.substring(0,3)).append("label").text(average).style("float", "right").style("font-weight","bold")
				d3.select("."+d.substring(0,3)).append("br")
				math.forEach(function(e) {
					d3.select("."+d).append("label").text(e).style("float", "left")
					d3.select("."+d).append("br")
					d3.select("."+d.substring(0,3)).append("label").text(student.year[index].grades.math[e])
					d3.select("."+d.substring(0,3)).append("br")
				})
			}
			else if (d=="english") {
				var arr = [];
				for (var i = 0; i<english.length;i++) {
					arr[i] = student.year[index].grades.english[english[i]]
				}
				var average = d3.mean(arr)
				if (average >= 90) {
					average = 'A'
				}
				else if (average >= 80 && average < 90) {
					average = 'B'
				}
				else if (average >= 70 && average < 80) {
					average = 'C'
				}
				else if (average >= 60 && average < 70) {
					average = 'D'
				}
				else {
					average = 'F'
				}
				d3.select("."+d.substring(0,3)).append("label").text(average).style("float", "right").style("font-weight","bold")
				d3.select("."+d.substring(0,3)).append("br")
				english.forEach(function(e) {
					d3.select("."+d).append("label").text(e).style("float", "left")
					d3.select("."+d).append("br")
					d3.select("."+d.substring(0,3)).append("label").text(student.year[index].grades.english[e]).style("float","right")
					d3.select("."+d.substring(0,3)).append("br")
				})
			}
			else if (d=="history") {
				var arr = [];
				for (var i = 0; i<history.length;i++) {
					arr[i] = student.year[index].grades.history[history[i]]
				}
				var average = d3.mean(arr)
				if (average >= 90) {
					average = 'A'
				}
				else if (average >= 80 && average < 90) {
					average = 'B'
				}
				else if (average >= 70 && average < 80) {
					average = 'C'
				}
				else if (average >= 60 && average < 70) {
					average = 'D'
				}
				else {
					average = 'F'
				}
				d3.select("."+d.substring(0,3)).append("label").text(average).style("float", "right").style("font-weight","bold")
				d3.select("."+d.substring(0,3)).append("br")
				history.forEach(function(e) {
					d3.select("."+d).append("label").text(e).style("float", "left")
					d3.select("."+d).append("br")
					d3.select("."+d.substring(0,3)).append("label").text(student.year[index].grades.history[e]).style("float","right")
					d3.select("."+d.substring(0,3)).append("br")
				})
			}
			else {
				var arr = [];
				for (var i = 0; i<english.length;i++) {
					arr[i] = student.year[index].grades.english[english[i]]
				}
				var average = d3.mean(arr)
				if (average >= 90) {
					average = 'A'
				}
				else if (average >= 80 && average < 90) {
					average = 'B'
				}
				else if (average >= 70 && average < 80) {
					average = 'C'
				}
				else if (average >= 60 && average < 70) {
					average = 'D'
				}
				else {
					average = 'F'
				}
				d3.select("."+d.substring(0,3)).append("label").text(average).style("float", "right").style("font-weight","bold")
				d3.select("."+d.substring(0,3)).append("br")
				science.forEach(function(e) {
					d3.select("."+d).append("label").text(e).style("float", "left")
					d3.select("."+d).append("br")
					d3.select("."+d.substring(0,3)).append("label").text(student.year[index].grades.science[e]).style("float","right")
					d3.select("."+d.substring(0,3)).append("br")
				})
			}
		})

		// grades.selectAll("label")
		// 	.data(keys)
		// 	.append("label")
		// 	.text()
			// .data(student.year[index].grades)
			// .class("")
			// .text(function(d) {console.log(d)})


	})

	var updateVis = function(selectedIndex){
		graphVis.onSelectionChange(selectedIndex);
	};

	function toggleMath() {
		console.log(mathShow);
		if (mathShow) {
			$( "#math" ).css( "display", "none" );
			mathShow = false;
		} else
		{
			$( "#math" ).css( "display", "block" );
			mathShow = true;
		}
		return;
	}
	
	function toggleHistory() {
		console.log(histShow);
		if (histShow) {
			$( "#history" ).css( "display", "none" );
			histShow = false;
		} else
		{
			$( "#history" ).css( "display", "block" );
			histShow = true;
		}
		return;
	}
	
	function toggleScience() {
		console.log(sciShow);
		if (sciShow) {
			$( "#science" ).css( "display", "none" );
			sciShow = false;
		} else
		{
			$( "#science" ).css( "display", "block" );
			sciShow = true;
		}
		return;

	}
	
	function toggleEnglish() {
		console.log(engShow);
		if (engShow) {
			$( "#english" ).css( "display", "none" );
			engShow = false;
		} else
		{
			$( "#english" ).css( "display", "block" );
			engShow = true;
		}
		return;

	}
	
	</script>
</head>

<body>
	<div id = "dashboard">
		<div id = "header">
		<br>
		<label class="name"> </label><br />
		Grade Report <br />
		<select onchange="updateVis(this.selectedIndex)">
		  <option value="3" id="gradeSelect">Grade 3</option>
		  <option value="2" id="gradeSelect">Grade 2</option>
		  <option value="1" id="gradeSelect">Grade 1</option>
		</select>
		</div>
		<div id = "back">
			<a href = "student.html" style ="font-size:15px;padding-left:2px">Back to Student Profile</a>
		</div>
		<div id = "overview">
			<div id = "weaknesses" style="top: 8.2%; height:30%">
				<p class = "header";>Weaknesses</p>

				<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. In rhoncus leo ante, et sollicitudin nulla eleifend nec. Vivamus eu convallis enim. Praesent eros sapien, fermentum in mollis et, maximus quis metus. Ut libero purus, semper id massa vitae, imperdiet bibendum nisi. Fusce a justo at quam posuere euismod ac non tellus. In hac habitasse platea dictumst. Nullam sollicitudin enim nunc, a placerat nisi blandit vestibulum. Pellentesque pretium quam malesuada quam feugiat pretium. Praesent placerat purus quis ipsum elementum, at hendrerit neque rutrum. Aenean purus lorem, bibendum sed feugiat vitae, aliquet vel mauris. Curabitur nec nulla ac mi sagittis suscipit quis non urna.</p>

				<p>Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus gravida euismod tellus, maximus efficitur turpis tempus vel. Ut fringilla odio et lectus cursus viverra. Ut volutpat tempus turpis, sed aliquam dolor vulputate sit amet. Nam auctor neque vitae risus venenatis commodo. Etiam lacinia turpis tincidunt semper sodales. Pellentesque quis sollicitudin massa. Proin tincidunt elit nisl, sed congue nibh convallis id. Fusce vitae mauris vel arcu accumsan gravida. Pellentesque at ultricies ante.</p>

				<p>Donec vitae tempus lectus. Donec semper tempor turpis non tincidunt. In sed libero eu diam euismod vulputate vitae ac nibh. Fusce blandit dui in elit porta aliquet. Nunc semper interdum sapien. Nunc condimentum felis non lacus porttitor, eget consequat massa fringilla. Ut facilisis lobortis tristique. In non pulvinar massa. Phasellus eu maximus metus.</p>
			</div>
			<div id = "select" style="top: 8.2%; left: 47.5%; float:left; height:27.7%; margin-left:10px; width:9%; padding-top:20px">
				<form id="weaknessSelector">
					<div style="margin-top:20px;margin-left:5px"><input type="checkbox" name="subject" value="math" style="float:left"><label style="float:left">Math</label></div><br />
					<div style="margin-top:20px;margin-left:5px"><input type="checkbox" name="subject" value="history" style="float:left"><label style="float:left">History</label></div><br />
					<div style="margin-top:20px;margin-left:5px"><input type="checkbox" name="subject" value="science" style="float:left"><label style="float:left">Science</label></div><br />
					<div style="margin-top:20px;margin-left:5px"><input type="checkbox" name="subject" value="english" style="float:left"><label style="float:left">English</label></div><br />
				</form>
			</div>
			<div id = "grades" style="height:61.2%">
			<div style="margin-top:30px;float:left;margin-left:47%;" class = "header">Math</div>
			<div style="margin-top:30px;margin-left:15.5px" class="arrow-down" onclick="toggleMath();"></div>
			<br clear="all"/>
			<div id="math" style="display:none;margin-top:20px">
				<div class="sub math" style="float:left"></div>
				<div class ="numeric mat" style="float:right"></div>
			</div>
			<br clear="all">
			<div>
			<div style="margin-top:10px;float:left;margin-left:45%" class = "header">History</div>
			<div style="margin-top:10px;float:left;margin-left:10px" class="arrow-down" onclick="toggleHistory();"></div>
			<br clear="all">
				<div id="history" style="display:none;margin-top:5px">
					<div class="sub history" style="float:left"></div>
					<div class ="numeric his" style="float:right"></div>
				</div>
			<br clear="all">
			<div style="margin-top:10px;float:left;margin-left:44%" class = "header">Science</div>
			<div style="margin-top:10px;margin-left:7px" class="arrow-down" onclick="toggleScience();"></div>
			<br clear="all">
				<div id="science" style="display:none;margin-top:5px">
					<div class="sub science" style="float:left"></div>
					<div class ="numeric sci" style="float:right"></div>
				</div>
			<br clear="all">
			<div style="margin-top:10px;float:left;margin-left:45%" class = "header">English</div>
			<div style="margin-top:10px;margin-left:8px" class="arrow-down" onclick="toggleEnglish();"></div>
			<br clear="all">
			<div id="english" style="display:none;margin-top:5px">
					<div id="math" class="sub english" style="float:left"></div>
					<div id="math" class ="numeric eng" style="float:right"></div>
			</div>
			<br clear="all">
			<a style="margin-left:20px;"type="btn btn-xs" href="change.html">View analysis</a>
			</div>

			<div id = "graph" style="top:52%; width:55.2%">
			</div>
		</div>
	</div>
</body>
</html>
